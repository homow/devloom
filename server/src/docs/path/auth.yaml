# Signup response and schema
signup:
  post:
    security: [ ]
    operationId: "createUser"
    summary: "create new user"
    description: "Create a new user in db collection(users)"
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/SignupRequest"
    responses:
      # success
      201:
        description: "user created successfully"
        content:
          application/json:
            example:
              ok: true
              message: "Sign up successfully"
              user:
                id: "695d0babedf79cffd1f83999"
                name: "john"
                email: "john@mail.co"
                createdAt: "2026-01-19T19:22:20.707Z"
                updatedAt: "2026-01-19T19:22:20.707Z"
                role: "USER"
      # conflict
      409:
        description: "Conflict"
        content:
          application/json:
            example:
              ok: false
              message: "email already exist"

      # invalid body
      422:
        description: "Unprocessable Entity"
        content:
          application/json:
            example:
              ok: false
              errors:
                - fields: name
                  message: "name must be at least 3 characters"

                - fields: password
                  message: "password must be at least 6 characters"

                - fields: email
                  message: "Invalid email address"

# Login response and schema
login:
  post:
    security: [ ]
    operationId: "login"
    summary: "login users"
    description: "login user with email and password"
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/LoginRequest"
    responses:
      # success
      200:
        description: "user logged in successfully"
        content:
          application/json:
            example:
              ok: true
              message: "login successfully"
              accessToken: "<accessToken Value>"
              user:
                id: "695d0babedf79cffd1f83999"
                name: "john"
                email: "john@mail.co"
                createdAt: "2026-01-19T19:22:20.707Z"
                updatedAt: "2026-01-19T19:22:20.707Z"
                role: "USER"

      # banned email
      403:
        description: "Forbidden. This account is banned. Login is not allowed."
        content:
          application/json:
            example:
              ok: false
              message: "This account is banned. Login is not allowed. Please contact support if you think this is a mistake."
              email: "john@mail.com"
              code: "BANNED_EMAIL"

      # invalid information
      401:
        description: "Unauthorized. invalid password or email."
        content:
          application/json:
            example:
              ok: false
              message: "Invalid Credentials"

# getMe response
getMe:
  get:
    operationId: "getMe"
    summary: "get user info"
    description: "get user safe-information in db collection(users)"
    tags:
      - "Auth"
    responses:
      # success
      200:
        description: "successfully get user info"
        content:
          application/json:
            example:
              ok: true
              message: "user successfully found"
              user:
                name: "john"
                email: "john@mail.co"
                role: "USER"
                id: "696e846cdd939b376e89608b"
                createdAt: "2026-01-19T19:22:20.707Z"
                updatedAt: "2026-01-19T19:22:20.707Z"

      # missed accessToken
      401:
        description: "Unauthorized - missed access token"
        content:
          application/json:
            example:
              ok: false
              message: "Access token is required"
              code: "ACCESS_TOKEN_MISSING"

# Logout user
logout:
  post:
    operationId: "logout"
    summary: "logout system"
    description: "logout user in the current system."
    tags:
      - "Auth"
    responses:
      # success
      200:
        description: "user logged out in the system successfully"
        content:
          application/json:
            example:
              ok: true
              message: 'Logged out successfully'

      # Unauthorized
      401:
        description: "Unauthorized - not login"
        content:
          application/json:
            example:
              ok: false
              message: "refresh token is missing or expired"
              code: "REFRESH_TOKEN_NOT_FOUND"

# refresh accessToken
refresh:
  post:
    operationId: "refresh"
    summary: "refresh accessToken"
    description: "get a new accessToken with refreshToken"
    tags:
      - "Auth"
    responses:
      # success
      200:
        description: "new accessToken created successfully."
        content:
          application/json:
            example:
              ok: true
              message: 'success'
              accessToken: '<AccessTokenValue>'
              user:
                name: 'john'
                email: 'john@mail.co'
                role: 'USER'
                id: '696f96416bd22d439cf79d3f'
                createdAt: '2026-01-20T14:50:41.946Z'
                updatedAt: '2026-01-20T14:50:41.946Z'

      # Unauthorized
      401:
        description: "missed or expired refresh token"
        content:
          application/json:
            example:
              ok: false
              message: "refresh token is missing or expired"
              code: "REFRESH_TOKEN_NOT_FOUND"

# get user list
users:
  get:
    operationId: "users"
    summary: "get users list"
    description: "get all users list **Access restricted to users with role: (ADMIN | SUPER_ADMIN) only.**"
    tags:
      - "Auth"
    responses:
      # success
      200:
        description: "get users list successfully."
        content:
          application/json:
            example:
              ok: true
              message: "users found"
              users:
                - name: "Bridie"
                  email: "alfredo.little@gmail.com"
                  role: "USER"
                  id: "695b5d0267a06ae7f2afb9f2"
                  createdAt: "2026-01-05T06:41:06.376Z"
                  updatedAt: "2026-01-05T06:41:06.376Z"

                - name: "Destin"
                  email: "felton47@gmail.com"
                  role: "USER"
                  id: "695b5d0567a06ae7f2afb9f6"
                  createdAt: "2026-01-05T06:41:09.937Z"
                  updatedAt: "2026-01-05T06:41:09.937Z"

                - name: "Braulio"
                  email: "johnfsdf@email.co"
                  role: "USER"
                  id: "695b7e95df07650a9c0784ca"
                  createdAt: "2026-01-05T09:04:21.031Z"
                  updatedAt: "2026-01-05T09:04:21.031Z"

                - name: "Odell"
                  email: "john@email.co"
                  role: "ADMIN"
                  id: "695ccd4520812fad88b856a2"
                  createdAt: "2026-01-06T08:52:21.759Z"
                  updatedAt: "2026-01-06T08:52:21.759Z"

      # Forbidden
      403:
        description: "Forbidden - not allowed for role"
        content:
          application/json:
            example:
              ok: false
              code: "ACCESS_DENIED"
              message: "Your role (USER) is not allowed to access a route requiring ADMIN (equal or higher)."

# get, delete and update one user
user:
  # get one user
  get:
    operationId: "getUser"
    summary: "get one user"
    description: "get one user **Access restricted to users with role: (ADMIN | SUPER_ADMIN) only.**"
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/GetUserRequest"
    responses:
      # success
      200:
        description: "user successfully found."
        content:
          application/json:
            example:
              ok: true
              message: "user found"
              user:
                name: "Odell"
                email: "john@email.co"
                role: "ADMIN"
                id: "695ccd4520812fad88b856a2"
                createdAt: "2026-01-06T08:52:21.759Z"
                updatedAt: "2026-01-06T08:52:21.759Z"

      # user not found
      404:
        description: "Not found - User not found"
        content:
          application/json:
            example:
              ok: false
              message: "user not found in database"
              code: "USER_NOT_FOUND"

      # Forbidden
      403:
        description: "Forbidden - not allowed for role"
        content:
          application/json:
            example:
              ok: false
              message: "You are not authorized to access this route."
              code: "ACCESS_DENIED"

  # delete one user
  delete:
    operationId: "deleteUser"
    summary: "delete one user"
    description: "Delete one user. **Access restricted to users with roles higher than the target user (ADMIN | SUPER_ADMIN) only.**"
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/GetUserRequest"
    responses:
      # success
      200:
        description: "user successfully deleted"
        content:
          application/json:
            example:
              ok: true
              message: "Successfully updated user"
              user:
                id: "695d58f71e66bde9eb688a20"
                name: "john"
                email: "john@mail.co"
                role: "USER"
                createdAt: "2026-01-06T18:48:23.495Z"
                updatedAt: "2026-01-08T13:31:48.981Z"

      # Forbidden
      403:
        description: "Forbidden - not allowed for role"
        content:
          application/json:
            example:
              ok: false
              message: "you cannot delete a user with equal or higher role"
              code: "ROLE_NOT_ALLOWED"

  # update one user
  patch:
    operationId: "updateUser"
    summary: "update one user"
    description: "Update user details by themselves."
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/UpdateUserRequest"
    responses:
      # success
      200:
        description: "user updated successfully."
        content:
          application/json:
            example:
              ok: true
              message: "Successfully updated user"
              user:
                id: "695d58f71e66bde9eb688a20"
                name: "john"
                email: "john@mail.co"
                role: "USER"
                createdAt: "2026-01-06T18:48:23.495Z"
                updatedAt: "2026-01-08T13:31:48.981Z"

      # bad request
      422:
        description: "Unprocessable Entity - invalid body"
        content:
          application/json:
            example:
              ok: false
              errors:
                - fields: "name"
                  message: "name must be at least 3 characters"

                - fields: "password"
                  message: "password must be at least 6 characters"

                - fields: "password"
                  message: "password must contain at least one letter and one number"

                - fields: "name, password"
                  message: "At least one of 'name' or 'password' must be provided"

# change userRole
userRole:
  # change userRole one user
  patch:
    operationId: "changeUserRole"
    summary: "change user role"
    description: "change user role **Access restricted to users with role: SUPER_ADMIN only.**"
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/ChangeUserRole"
    responses:
      # success
      200:
        description: "user successfully found."
        content:
          application/json:
            example:
              ok: true
              message: "User role updated successfully"
              userTarget:
                name: "Odell"
                email: "john@email.co"
                role: "ADMIN"
                id: "695ccd4520812fad88b856a2"
                createdAt: "2026-01-06T08:52:21.759Z"
                updatedAt: "2026-01-06T08:52:21.759Z"

      # Bad Request
      400:
        description: "user successfully found."
        content:
          application/json:
            example:
              ok: false
              message: "You are not allowed to change your own role."
              code: "CANNOT_CHANGE_OWN_ROLE"

      # Conflict
      409:
        description: "Conflict role"
        content:
          application/json:
            example:
              ok: false
              code: "ROLE_ALREADY_ASSIGNED"
              message: "The user already has the role USER"
              userTarget:
                name: "Odell"
                email: "john@email.co"
                role: "USER"
                id: "695ccd4520812fad88b856a2"
                createdAt: "2026-01-06T08:52:21.759Z"
                updatedAt: "2026-01-06T08:52:21.759Z"
      # Forbidden
      403:
        description: "Forbidden - ACCESS_DENIED"
        content:
          application/json:
            example:
              ok: false
              message: "Your role (ADMIN) is not allowed to access a route requiring ADMIN (higher)"
              code: "ACCESS_DENIED"

# ban user
banUser:
  # change userRole one user
  post:
    operationId: "banUser"
    summary: "ban user"
    description: "ban user **Access restricted to users with role: (SUPER_ADMIN or ADMIN) only.**"
    tags:
      - "Auth"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schema/auth.yaml#/GetUserRequest"
    responses:
      # success
      200:
        description: "success"
        content:
          application/json:
            example:
              ok: false
              message: "user banned successfully"
              "user":
                name: "Odell"
                email: "john@email.co"
                role: "USER"
                id: "695ccd4520812fad88b856a2"
                createdAt: "2026-01-06T08:52:21.759Z"
                updatedAt: "2026-01-06T08:52:21.759Z"

      403:
        description: "Forbidden - ACCESS_DENIED"
        content:
          application/json:
            example:
              ok: false
              message: "you cannot ban a user with equal or higher role"
              code: "ROLE_NOT_ALLOWED"

      409:
        description: "Conflict"
        content:
          application/json:
            example:
              ok: false
              message: "The user is currently banned."
              email: "john@mail.co"